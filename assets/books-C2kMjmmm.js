import{s as n}from"./index-BY91njIG.js";const c=n("books",{state:()=>({allBooks:[],cart:[],purchasedBooks:[],isLoading:!1}),getters:{cartItemsCount(e){return e.cart.reduce((t,o)=>t+o.quantity,0)},cartTotal(e){return e.cart.reduce((t,o)=>{const s=e.allBooks.find(a=>a.id===o.bookId);return t+(s?s.price*o.quantity:0)},0)},availableBooks(e){return e.allBooks.filter(t=>t.stock>0)},libraryBooks(e){return e.purchasedBooks.map(t=>({...e.allBooks.find(s=>s.id===t.bookId),...t}))},isInCart:e=>t=>e.cart.some(o=>o.bookId===t),isPurchased:e=>t=>e.purchasedBooks.some(o=>o.bookId===t)},actions:{async initializeBooks(){this.isLoading=!0;const e=this.generateBookMetadata();this.allBooks=e.map(t=>({...t,stock:Math.floor(Math.random()*20)+5,price:Math.floor(Math.random()*20)+10,rating:(Math.random()*2+3).toFixed(1)})),this.isLoading=!1},generateBookMetadata(){const e=["J.K. Rowling","J.R.R. Tolkien","George Orwell","Paulo Coelho","Antoine de Saint-ExupÃ©ry","F. Scott Fitzgerald","Jane Austen","Ernest Hemingway","Gabriel GarcÃ­a MÃ¡rquez","Harper Lee"],t=["Fantasy","Sci-Fi","Klasika","Romantika","Thriller","DobrodruÅ¾stvo"],o=["ğŸ“š","ğŸ“–","ğŸ“•","ğŸ“—","ğŸ“˜","ğŸ“™","âš¡","ğŸ’","ğŸ‘ï¸","ğŸ§ª","ğŸ‘‘","ğŸŒŸ"],s=["#FFD700","#8B4513","#2C3E50","#E67E22","#3498DB","#9B59B6","#E74C3C","#27AE60"],a=[];for(let r=1;r<=100;r++)a.push({id:r,filename:`Book${r}.txt`,title:`Kniha ${r}`,author:e[Math.floor(Math.random()*e.length)],genre:t[Math.floor(Math.random()*t.length)],emoji:o[Math.floor(Math.random()*o.length)],color:s[Math.floor(Math.random()*s.length)],description:"FascinujÃºci prÃ­beh, ktorÃ½ vÃ¡s pohltÃ­ od prvej do poslednej strany. TÃ¡to kniha sa stala bestsellerom a zÃ­skala mnoÅ¾stvo ocenenÃ­.",pages:Math.floor(Math.random()*400)+100});return a},addToCart(e,t=1){const o=this.allBooks.find(a=>a.id===e);if(!o)return{success:!1,message:"Kniha nebola nÃ¡jdenÃ¡"};if(o.stock<t)return{success:!1,message:"Nedostatok kusov na sklade"};const s=this.cart.find(a=>a.bookId===e);if(s){if(o.stock<s.quantity+t)return{success:!1,message:"Nedostatok kusov na sklade"};s.quantity+=t}else this.cart.push({bookId:e,quantity:t,addedAt:new Date().toISOString()});return{success:!0,message:"PridanÃ© do koÅ¡Ã­ka"}},removeFromCart(e){const t=this.cart.findIndex(o=>o.bookId===e);t!==-1&&this.cart.splice(t,1)},updateCartQuantity(e,t){const o=this.cart.find(a=>a.bookId===e),s=this.allBooks.find(a=>a.id===e);return!o||!s?{success:!1}:t<=0?(this.removeFromCart(e),{success:!0}):t>s.stock?{success:!1,message:"Nedostatok kusov na sklade"}:(o.quantity=t,{success:!0})},clearCart(){this.cart=[]},async checkout(){if(this.cart.length===0)return{success:!1,message:"KoÅ¡Ã­k je prÃ¡zdny"};for(const t of this.cart){const o=this.allBooks.find(s=>s.id===t.bookId);if(!o||o.stock<t.quantity)return{success:!1,message:`Nedostatok kusov: ${o?.title||"neznÃ¡ma kniha"}`}}for(const t of this.cart){const o=this.allBooks.find(s=>s.id===t.bookId);o.stock-=t.quantity;for(let s=0;s<t.quantity;s++)this.purchasedBooks.push({bookId:t.bookId,purchasedAt:new Date().toISOString(),status:"planned",progress:0})}const e={items:[...this.cart],total:this.cartTotal,date:new Date().toISOString()};return this.clearCart(),{success:!0,message:"ObjednÃ¡vka ÃºspeÅ¡ne dokonÄenÃ¡",order:e}},updateReadingProgress(e,t){const o=this.purchasedBooks.find(s=>s.bookId===e);o&&(o.progress=t,t===100?o.status="completed":t>0&&(o.status="reading"))},async loadBookContent(e){try{const t=this.allBooks.find(o=>o.id===e);if(!t)return null;try{const o=await fetch(`/books/${t.filename}`);if(!o.ok)throw new Error("Book file not found");const s=await o.text();return{...t,content:s}}catch{return console.warn(`Kniha ${t.filename} sa nenaÅ¡la, pouÅ¾ije sa placeholder`),{...t,content:null}}}catch(t){return console.error("Chyba pri naÄÃ­tanÃ­ knihy:",t),null}}}});export{c as u};
